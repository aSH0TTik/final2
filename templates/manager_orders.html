{% extends 'base.html' %}
{% load static %}

{% block title %}Управление заказами{% endblock %}

{% block content %}
    <h2>Все заказы клиентов</h2>
    {% if orders %}
        <table style="width:100%; border-collapse: collapse;">
            <tr style="background: #eee;">
                <th>Номер</th><th>Клиент</th><th>Дата</th><th>Сумма</th><th>Статус</th><th>Изменить статус</th>
            </tr>
            {% for order in orders %}
                <tr>
                    <td>{{ order.id }}</td>
                    <td>{{ order.user.username }}</td>
                    <td>{{ order.created_at|date:"d.m.Y H:i" }}</td>
                    <td>{{ order.total_price }} ₽</td>
                    <td>{{ order.get_status_display }}</td>
                    <td>
                        <form method="post" style="display:inline;">
                            {% csrf_token %}
                            <input type="hidden" name="order_id" value="{{ order.id }}">
                            <select name="status">
                                {% for value, label in order.STATUS_CHOICES %}
                                    <option value="{{ value }}" {% if value == order.status %}selected{% endif %}>{{ label }}</option>
                                {% endfor %}
                            </select>
                            <button type="submit">Изменить</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>Заказов нет.</p>
    {% endif %}
{% endblock %}